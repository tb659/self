(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["allorder~order"],{"053b":function(t,e,r){var a=r("1e2c"),n=r("d910").f,i=Function.prototype,o=i.toString,s=/^\s*function ([^ (]*)/,l="name";a&&!(l in i)&&n(i,l,{configurable:!0,get:function(){try{return o.call(this).match(s)[1]}catch(t){return""}}})},"2cdb":function(t,e,r){},"2eeb":function(t,e,r){"use strict";var a=r("1c8b"),n=r("5dfd").map,i=r("1ea7"),o=r("ff9c"),s=i("map"),l=o("map");a({target:"Array",proto:!0,forced:!s||!l},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},4319:function(t,e,r){},"54d5":function(t,e,r){"use strict";var a=r("2cdb"),n=r.n(a);n.a},"6aee":function(t,e,r){"use strict";var a=r("ee3b"),n=r.n(a);n.a},"8f9c":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-form",{staticClass:"form_border",attrs:{inline:!0,model:t.queryForm}},[r("el-form-item",{attrs:{label:"订单编号"}},[r("el-input",{attrs:{size:"small",placeholder:"订单编号"},model:{value:t.queryForm.orderNo,callback:function(e){t.$set(t.queryForm,"orderNo",e)},expression:"queryForm.orderNo"}})],1),r("el-form-item",{attrs:{label:"设备名称"}},[r("el-input",{attrs:{size:"small",placeholder:"设备名称"},model:{value:t.queryForm.deviceName,callback:function(e){t.$set(t.queryForm,"deviceName",e)},expression:"queryForm.deviceName"}})],1),t.queryForm.isAll?r("el-form-item",{attrs:{label:"选择公司",prop:"enterpriseId"}},[r("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":t.queryEnterprise,placeholder:"请输入公司名称",clearable:""},on:{blur:t.mustSel,select:t.enterpriseHandleSelect},model:{value:t.enterpriseName,callback:function(e){t.enterpriseName=e},expression:"enterpriseName"}})],1):t._e(),r("el-form-item",{attrs:{label:"下单时间"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择开始时间"},on:{change:function(e){t.changeDate(e,"startDate")}},model:{value:t.queryForm.startDate,callback:function(e){t.$set(t.queryForm,"startDate",e)},expression:"queryForm.startDate"}})],1),r("el-form-item",{attrs:{label:"结束时间",prop:"endDate"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择结束时间"},on:{change:function(e){t.changeDate(e,"endDate")}},model:{value:t.queryForm.endDate,callback:function(e){t.$set(t.queryForm,"endDate",e)},expression:"queryForm.endDate"}})],1),r("el-form-item",[r("el-button",{staticClass:"_bgcolor",attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.search(e)}}},[t._v("查询")])],1)],1),t.tableData.length?t._e():r("div",{staticClass:"no_order"},[t._v("暂无订单")]),r("order-item",{attrs:{orderList:t.tableData},on:{getSearch:t.search}}),t.queryInfo.total?r("div",{staticClass:"MT_pagination"},[r("span",{staticClass:"jump_first",on:{click:function(e){return e.stopPropagation(),t.$jumpToFirst(t.queryInfo,t.changePage)}}},[t._v("首页")]),r("span",{staticClass:"jump_last",on:{click:function(e){return e.stopPropagation(),t.$jumpToLast(t.queryInfo,t.changePage)}}},[t._v("尾页")]),r("el-pagination",{attrs:{background:"",total:t.queryInfo.total,"current-page":t.queryInfo.page,"page-size":t.queryInfo.size,layout:"total, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.queryInfo,"page",e)},"update:current-page":function(e){return t.$set(t.queryInfo,"page",e)},"update:pageSize":function(e){return t.$set(t.queryInfo,"size",e)},"update:page-size":function(e){return t.$set(t.queryInfo,"size",e)},"current-change":t.changePage}})],1):t._e()],1)},n=[],i=(r("2eeb"),r("053b"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"waiting_order_cont"},t._l(t.tableData,(function(e,a){return r("div",{key:a,staticClass:"waiting_order"},[r("div",{staticClass:"order_hd"},[r("div",{staticClass:"order_name"},[r("div",{staticClass:"shop_info"},[r("el-row",[r("el-col",{attrs:{span:4}},[t._v(t._s(e.deviceName))]),r("el-col",{attrs:{span:4}},[t._v(" 订单金额："),r("b",[t._v(t._s(t.getOrderAmount(e))+" 元")])]),0==e.orderType?r("el-col",{attrs:{span:4}},[t._v(" "+t._s(t.dateFormat(e.createDatetime))+" 下单 ")]):t._e(),1==e.orderType?r("el-col",{attrs:{span:4}},[t._v(" 退款时间："+t._s(t.dateFormat(e.createDatetime))+" ")]):t._e(),e.orderNo&&0==e.orderType?r("el-col",{attrs:{span:4}},[t._v(" 订单编号："+t._s(e.orderNo)+" ")]):t._e(),e.orderNo&&1==e.orderType?r("el-col",{attrs:{span:4}},[t._v(" 退款订单编号："+t._s(e.orderNo)+" ")]):t._e()],1),r("div",{staticClass:"btns"},[0==e.orderType?r("el-button",{on:{click:function(r){return r.stopPropagation(),t.refuseRefundDialog(e)}}},[t._v("退款")]):t._e()],1)],1)]),0==e.orderType?r("div",{staticClass:"handle_info"},[1==e.orderType?r("div",{staticClass:"price"},[t._v(" 退款备注："),r("b",{staticStyle:{color:"#f00","font-weight":"bold"}},[t._v(t._s(e.refundMemo))])]):t._e()]):t._e(),"S"==e.orderState?r("div",{staticClass:"paid",staticStyle:{background:"#40DE40"}},[t._v("成功")]):"T"==e.orderState?r("div",{staticClass:"paid",staticStyle:{background:"#f60"}},[t._v("处理中")]):"E"==e.orderState?r("div",{staticClass:"paid",staticStyle:{background:"#f00"}},[t._v("失败")]):"R"==e.orderState?r("div",{staticClass:"paid",staticStyle:{background:"#f60"}},[t._v("冲正")]):"C"==e.orderState?r("div",{staticClass:"paid",staticStyle:{background:"#f60"}},[t._v("撤销")]):"F"==e.orderState?r("div",{staticClass:"paid",staticStyle:{background:"#f60"}},[t._v("退款")]):"U"==e.orderState?r("div",{staticClass:"paid",staticStyle:{background:"#f60"}},[t._v("未扫码")]):"N"==e.orderState?r("div",{staticClass:"paid",staticStyle:{background:"#f60"}},[t._v("未知")]):t._e()]),r("div",{staticClass:"order_bd"},[r("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:[].concat(e)}},[0==e.orderType?r("el-table-column",{attrs:{prop:"itemName",label:"商品名称",width:t.isIE?"450":""}}):t._e(),0==e.orderType?r("el-table-column",{attrs:{prop:"amount",label:"原价",width:"200"}}):t._e(),1==e.orderType?r("el-table-column",{attrs:{prop:"refundOrderNo",label:"原订单编号"}}):t._e(),1==e.orderType?r("el-table-column",{attrs:{prop:"sellAmount",label:"原订单金额",width:"200"}}):t._e(),1==e.orderType?r("el-table-column",{attrs:{prop:"refundSellAmount",label:"退款金额",width:"200"}}):t._e(),r("el-table-column",{attrs:{prop:"drinkType",label:"温度",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(1==e.row.drinkType?"热饮":"冷饮")+" ")]}}],null,!0)}),r("el-table-column",{attrs:{prop:"sugarWeight",label:"甜度",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(0==e.row.sugarWeight?"无糖":1==e.row.sugarWeight?"半糖":"全糖")+" ")]}}],null,!0)}),0==e.orderType?r("el-table-column",{attrs:{prop:"channelType",label:"支付方式",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("WX"==e.row.channelType?"微信":"ZFB"==e.row.channelType?"支付宝":"其他")+" ")]}}],null,!0)}):t._e(),1==e.orderType?r("el-table-column",{attrs:{prop:"channelType",label:"退款方式",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("WX"==e.row.channelType?"微信":"ZFB"==e.row.channelType?"支付宝":"其他")+" ")]}}],null,!0)}):t._e()],1)],1)])})),0),r("el-dialog",{attrs:{title:"退款备注",visible:t.refundDialog,width:"25%"},on:{"update:visible":function(e){t.refundDialog=e}}},[r("el-divider"),t._v(" 退款备注："),r("el-input",{attrs:{type:"text",placeholder:""},model:{value:t.refundMemo,callback:function(e){t.refundMemo=e},expression:"refundMemo"}}),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.refundDialog=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:t.refuseRefund}},[t._v("确 定")])],1)],1)],1)}),o=[],s=(r("ecb4"),r("77ad"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{staticClass:"select_shop",attrs:{title:"部分退款",visible:t.dialogStatus,width:"80%"},on:{"update:visible":function(e){t.dialogStatus=e}}},[r("el-divider"),r("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.details}},[r("el-table-column",{attrs:{prop:"chainCode",label:"商品编码",width:"100"}}),r("el-table-column",{attrs:{prop:"title",label:"商品名称"}}),r("el-table-column",{attrs:{prop:"quantity",label:"数量",width:"80"}}),r("el-table-column",{attrs:{prop:"amount",label:"总价",width:"100"}}),r("el-table-column",{attrs:{prop:"refundQuantity",label:"退货数量",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return["退款总计"!=e.row.chainCode?r("el-input-number",{staticStyle:{width:"100px"},attrs:{"controls-position":"right","step-strictly":!0,size:"mini",step:1,min:0,max:e.row.quantity},on:{change:function(r){return t.changeRfAmount(e.row)}},model:{value:e.row.refundQuantity,callback:function(r){t.$set(e.row,"refundQuantity",r)},expression:"scope.row.refundQuantity"}}):r("span",[t._v(t._s(e.row.refundQuantity))])]}}])}),r("el-table-column",{attrs:{prop:"refundAmount",label:"退货金额",width:"100"}}),r("el-table-column",{attrs:{prop:"marketSpecialId",label:"优惠信息",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.marketSpecialId?[t._v(" "+t._s(e.row.originalPrice)+"￥ ")]:void 0}}],null,!0)})],1),r("span",{staticClass:"select_store_btn"},[r("el-button",{on:{click:function(e){e.stopPropagation(),t.dialogStatus=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.refundPart(e)}}},[t._v("确 定")])],1)],1)}),l=[],u=(r("dbb3"),r("ea69"),{data:function(){return{dialogStatus:!1,details:[],orderId:""}},mounted:function(){},methods:{showDialog:function(t,e,r){this.orderId=e,this.dialogStatus=!0,this.details=t;var a=r?3:2;this.details.splice(this.details.length-a,a);for(var n=0;n<this.details.length;n++)this.details[n].refundQuantity=0,this.details[n].refundAmount=0,this.details[n].detailId=this.details[n].id;var i={chainCode:"退款总计",refundQuantity:0,refundAmount:0};this.details.push(i)},changeRfAmount:function(t){this.details[this.details.length-1].refundQuantity=0,this.details[this.details.length-1].refundAmount=this.$accSub(this.details[this.details.length-1].refundAmount,t.refundAmount),t.refundAmount=this.$accMul(t.refundQuantity,t.sellPrice),this.details[this.details.length-1].refundAmount=this.$accAdd(this.details[this.details.length-1].refundAmount,t.refundAmount);for(var e=0;e<this.details.length-1;e++)this.details[this.details.length-1].refundQuantity+=this.details[e].refundQuantity},refundPart:function(){this.details.pop(),this.details=this.details.filter((function(t){return 0!==t.refundQuantity}));this.orderId,this.details}}}),d=u,c=(r("54d5"),r("9ca4")),f=Object(c["a"])(d,s,l,!1,null,"4b976f42",null),p=f.exports,h={components:{refundPart:p},props:["orderList"],data:function(){return{isRefund:!1,printOrder:{details:[]},tableData:[],deliveryType:"",orderStatus:"",orderInfo:"",refundDialog:!1,isIE:!1,selectId:"",refundMemo:""}},filters:{formatPhone:function(t){return t+="",t.slice(0,3)+"****"+t.slice(7)}},computed:{dateFormat:function(){var t=this;return function(e){return t.$moment(e).format("YYYY-MM-DD HH:MM:SS")}}},methods:{getOrderAmount:function(t){return t.sellAmount?t.sellAmount:0},refuseRefundDialog:function(t){this.selectId=t.id,this.refundMemo="",this.refundDialog=!0},refuseRefund:function(){var t=this,e={orderId:this.selectId,refundMemo:this.refundMemo};this.$confirm("是否确认退款？","退款提醒",{type:"warning"}).then((function(){t.httpPost("/order/refund",e).then((function(e){t.$message.success("退款成功"),t.$emit("getSearch","")}))})).catch((function(){}))},initLoadData:function(){this.$emit("initLoadData")},minus:function(t,e){return this.$accSub(t,e)}},watch:{orderList:function(t,e){this.tableData=t}},mounted:function(){1==this.orderList.orderType&&(this.isRefund=!0);var t=navigator.userAgent;t.indexOf("Trident")>-1?this.isIE=!0:this.isIE=!1}},m=h,b=(r("fdde"),Object(c["a"])(m,i,o,!1,null,"4799ba64",null)),y=b.exports,g={components:{OrderItem:y},props:["tableData","queryForm"],data:function(){return{queryInfo:this.queryForm,enterpriseName:""}},methods:{enterpriseHandleSelect:function(t){this.enterpriseName=t.name,this.queryInfo.enterpriseId=t.id},queryEnterprise:function(t,e){this.associateQuery(t,e,"/basic/enterprise/query","httpPost")},associateQuery:function(t,e,r,a){var n=this,i={size:10,page:1,total:"",state:1,name:t};this[a](r,i,null,!0).then((function(t){t.rows.map((function(t){return t.value=t.name})),n.restaurants=t.rows,e(n.restaurants)}))},mustSel:function(){this.enterpriseId||(this.enterpriseName=null)},changePage:function(){this.$emit("getPage",this.queryInfo.page)},search:function(){this.$emit("getSearch",this.queryInfo)},refund:function(t){this.$emit("enable",t)}},watch:{},mounted:function(){}},v=g,_=(r("6aee"),Object(c["a"])(v,a,n,!1,null,"11e8aa9c",null));e["a"]=_.exports},dbb3:function(t,e,r){"use strict";var a=r("1c8b"),n=r("5dfd").filter,i=r("1ea7"),o=r("ff9c"),s=i("filter"),l=o("filter");a({target:"Array",proto:!0,forced:!s||!l},{filter:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},ee3b:function(t,e,r){},fdde:function(t,e,r){"use strict";var a=r("4319"),n=r.n(a);n.a}}]);
//# sourceMappingURL=allorder~order.f0d825b8.js.map